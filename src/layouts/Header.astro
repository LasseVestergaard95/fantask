---
const url = "https://awccwteuyfoulnztrlsc.supabase.co/rest/v1/scrolling_banner?";
const apikey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF3Y2N3dGV1eWZvdWxuenRybHNjIiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODQyMzUzNzAsImV4cCI6MTk5OTgxMTM3MH0.j55yJxX0YRq2JVBAyJGzGEdMi5qoOAeM0vZNgy-y7nE"

const options = {
    headers: {
        apikey: apikey
    }
}

const response = await fetch(url, options);
const data = await response.json();
---

<header>
    <div class="top_header">
        <div class="fantask_logo">
            <a href="/">
                <img src="fantask_header_logo.svg" alt="">
            </a>
        </div>
        <nav class="main_nav_container">
            <ul class="main_nav">
                <li>
                    <a href="/">Nyheder</a>
                </li>
                <li class="tegneserier_li">
                    <a href="/Tegneserie">Tegneserier</a>
                    <div class="submenu">
                        <div class="bubble">
                            <ul>Browse
                                <li>
                                    <a href="/Tegneserie">Titler A-Z</a>
                                </li>
                                <li>
                                    <a href="/Tegneserie">Forfattere</a>
                                </li>
                                <li>
                                    <a href="/Tegneserie">Serier</a>
                                </li>
                            </ul>
                            <ul>Genrer
                                <li>
                                    <a href="/Tegneserie">Amerikanske blade</a>
                                </li>
                                <li>
                                    <a href="/Manga">Manga</a>
                                </li>
                                <li>
                                    <a href="/Tegneserie">Danske album</a>
                                </li>
                                <li>
                                    <a href="/Tegneserie">Danske blade</a>
                                </li>
                                <li>
                                    <a href="/Tegneserie">Hardcover</a>
                                </li>
                                <li>
                                    <a href="/Tegneserie">Trade paperbacks</a>
                                </li>
                                <li>
                                    <a href="/Tegneserie">Hentai</a>
                                </li>
                            </ul>
                        </div>
                        <div class="pointer"></div>
                    </div>
                </li>
                <li class="bøger_li">
                    <a href="/Bog">Bøger</a>
                    <div class="submenu">
                        <div class="bubble">
                            <ul>Browse
                                <li>
                                    <a href="/Bog">Titler A-Z</a>
                                </li>
                                <li>
                                    <a href="/Bog">Forfattere</a>
                                </li>
                                <li>
                                    <a href="/Bog">Serier</a>
                                </li>
                            </ul>
                            <ul>Genrer
                                <li>
                                    <a href="/Bog">Adventure</a>
                                </li>
                                <li>
                                    <a href="/Fantasy">Fantasy</a>
                                </li>
                                <li>
                                    <a href="/Horror">Horror</a>
                                </li>
                                <li>
                                    <a href="/Sci-Fi">Science Fiction</a>
                                </li>
                                <li>
                                    <a href="/Bog">Krimi</a>
                                </li>
                                <li>
                                    <a href="/Bog">Young Adult</a>
                                </li>
                                <li>
                                    <a href="/Bog">Non-fiction</a>
                                </li>
                            </ul>
                        </div>
                        <div class="pointer"></div>
                    </div>

                </li>
                <li>
                    <a href="">Hobby</a>
                </li>
                <li>
                    <a href="/gavekort">Gavekort</a>
                </li>
                <li>
                    <a href="/guides">Guides</a>
                </li>
                <li>
                    <a href="/om_os">Om os</a>
                </li>
            </ul>
        </nav>
        <nav>
            <ul class="user_nav">
                <li>
                    <lottie-player class="burgermenu" src="menuV2.json"  background="transparent"  speed="1.7"></lottie-player>
                </li>
                <li>
                    <button class="search">
                        <img src="header_search.svg" alt="">
                    </button>
                </li>

                <li>
                    <a href="">
                        <img src="header_favoritter_hvidt_hjerte.svg" alt="">
                    </a>
                </li>
                <li>
                    <a href="">
                        <img src="header_shopping_cart.svg" alt="">
                    </a>
                </li>
            </ul>
        </nav>
    </div>

</header>
<div class="top_banner">
    <ul class="scrolling_banner">

        {
            data.map((item) => {
                return (
                    <li>{item.text}</li>
                    <li>|</li>
                )
            })
        }
        {
            data.map((item) => {
                return (
                    <li>{item.text}</li>
                    <li>|</li>
                )
            })
        }

    </ul>
</div>


<!-- Include Lottie player library -->
<script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>

<script>
    // Get the burger menu element
    const nav = document.querySelector('.burgermenu');
    // Get the main navigation links element
    const navLinks = document.querySelector('.main_nav');
    // Variable to track the clicked state
    let clicked = false;

    // Add click event listener to the burger menu
    nav.addEventListener('click', () => {
        if (clicked) {
            // Reverse the animation direction
            nav.setDirection(-1);
            // Play the animation
            nav.play();
            // Reset clicked state
            clicked = false;
            // Animate the nav links to hide them
            navLinks.animate([
                { opacity: 1, pointerEvents: 'all'},
                { opacity: 0, pointerEvents: 'none'}
            ], {
                duration: 300,
                easing: 'ease-in-out',
                fill: 'forwards'
            });
        } else {
            // Set the animation direction to forward
            nav.setDirection(1);
            // Play the animation
            nav.play();
            // Set clicked state to true
            clicked = true;
            // Animate the nav links to show them
            navLinks.animate([
                { opacity: 0, pointerEvents: 'none'},
                { opacity: 1, pointerEvents: 'all'}
            ], {
                duration: 300,
                easing: 'ease-in-out',
                fill: 'forwards'
            });
        }
    });

    // Check for window resize event
    window.addEventListener('resize', () => {
        // If the screen width is more than 1200px
        if (window.innerWidth > 1200) {
            // Animate the nav links to make them visible
            navLinks.animate([
                { opacity: 1, pointerEvents: 'all'}
            ], {
                duration: 0,
                easing: 'ease-in-out',
                fill: 'forwards'
            });
        }
        // If the screen width is less than or equal to 1200px
        else {
            // Animate the nav links to hide them
            navLinks.animate([
                { opacity: 0, pointerEvents: 'none'}
            ], {
                duration: 0,
                easing: 'ease-in-out',
                fill: 'forwards'
            });
        }
    });
</script>



<style>

    /* Utility Classes */

    .hide {
        opacity: 0;
        pointer-events: none;
    }

    /* Header Styles */

    header {
        z-index: 9999;

    }

    a {
        text-decoration: none;
        color: var(--black);
    }

    li {
        list-style: none;
    }

    .top_header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background-color: var(--dark-blue);
        height: 4rem;
        padding-inline: 2rem;
    }

    .fantask_logo img {
        width: 8rem;
    }

    .burgermenu {
        transform: translateY(0.24rem) translateX(0.18rem);
        cursor: pointer;
        width: 2rem;
    }

    /* Main Navigation Styles */

    .main_nav_container {
        position: relative;
        width: 100%;
        height: 100%;
    }

    .main_nav {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        position: absolute;
        top: 50%;
        right: 0;
        height: fit-content;
        max-height: 90vh;
        pointer-events: none;
        overflow: hidden;
        white-space: nowrap;
        background-color: var(--white);
        color: var(--black);
        border-radius: 15px;
        border-top-right-radius: 0;
        border: 1px solid var(--black);
        transform: translateX(-0%);
        padding: 1rem;
        box-shadow: 0px 0px 16px 0px rgba(0, 0, 0, 0.314);
        /* no scrollbar */
        scrollbar-width: none;
        -ms-overflow-style: none;
        z-index: 99999999;
    }

    .main_nav > li {
        margin-right: 1rem;
        font-size: 16px;
        z-index: 1;
        padding: 1rem;
        transition: opacity 0.2s ease-in-out;
        position: relative;
        font-weight: medium;
        height: fit-content;
    }

    .main_nav:has(li:hover) > li:not(:hover) {
        opacity: 0.5;
    }

    .submenu {
        position: absolute;
        width: fit-content;
        opacity: 0;
        border-radius: 15px;
        background-color: var(--white);
        padding: 3rem;
        border: 1px solid var(--black);
        box-shadow: 0px 0px 16px 0px rgba(0, 0, 0, 0.314);
        pointer-events: none;
        transition: opacity 0.2s ease-in-out;
    }

    .bøger_li .submenu {
        transform: translateX(-43.5%) translateY(7%);
    }

    .tegneserier_li .submenu {
        transform: translateX(-38%) translateY(7%);
    }

    .submenu ul {
        font-weight: 600;
        font-size: 20px;
    }

    .submenu ul a {
        font-weight: 400;
        color: var(--black);
    }

    .submenu li {
        font-size: 16px;
        margin-top: 0.1rem;
        opacity: 1;
    }

    .submenu li:first-of-type {
        margin-top: 0.2rem;
    }

    .pointer {
        width: 7rem;
        height: 7rem;
        position: absolute;
        background-color: var(--white);
        transform: translateX(-50%) translateY(-50%);
        clip-path: polygon(50% 40%, 0% 100%, 100% 100%);
        inset: (0% 45% 0% 45% round 10px);
        border-radius: 5px;
        top: -0.5rem;
        left: 50%;
        z-index: -1;
        padding-inline: 6rem;
    }

    .bubble {
        display: flex;
        gap: 3rem;
    }

    /* User Navigation Styles */

    .user_nav {
        display: flex;
        width: 100%;
        align-items: baseline;
    }

    .user_nav li {
        margin-right: 1rem;
    }

    .user_nav img {
        width: 1.5rem;
    }

    /* Top Banner Styles */

    .top_banner {
        background-color: var(--top-banner);
        overflow: hidden;
        white-space: nowrap;
        width: 100%;
        box-shadow: 0px 5px 14px 0px #275ec424;
        z-index: 2;
        position: sticky;
        top: 0;
    }

    .scrolling_banner {
        display: inline-block;
        padding-block: 0.6rem;
        animation: scroll 70s linear infinite;
        width: fit-content;
    }

    .scrolling_banner li {
        color: var(--white);
        font-size: 16px;
        display: inline;
        margin-right: 10rem;
    }


    @keyframes scroll {
        0% {
            transform: translateX(0%);
        }
         100% {
            transform: translateX(-50%);
        }
    }

    /* Search Styles */

    .search {
        background: none;
        border: none;
        cursor: pointer;
    }

    /* Media Query Styles */

    @media screen and (min-width: 1200px) {
       
        a {
            color: var(--white);
        }

        .scrolling_banner li {
            font-size: 16px;
        }

        .burgermenu {
            display: none;
        }

        .main_nav_container {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            height: 100%;
        }
        .main_nav {
            display: flex;
            justify-content: space-between;
            flex-direction: row;
            background-color: var(--dark-blue);
            color: var(--white);
            border-radius: 0;
            border: none;
            transform: none;
            position: relative;
            align-items: center;
            padding: 0;
            max-height: 5rem;
            overflow: visible;
            position: initial;
            origin: initial;
            opacity: 1;
            pointer-events: all;
            box-shadow: none;
            scale: 1;  
        }

        .fantask_logo img {
            width: 16rem;
            transform: translateY(-0.2rem);
        }

        .top_header {
            height: 5rem;
        }

        .top_banner {
            top: 0rem;
        }

        .submenu {
            display: block;
            color: var(--black);
            z-index: 99999;
        }

        li:hover .submenu {
            opacity: 1;
            pointer-events: all;

        }

    }

</style>
